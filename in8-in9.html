<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Lens Uploads</title>

<style>
:root{
  --bg:#020617;
  --border:rgba(255,255,255,.08);
  --text:#e5e7eb;
  --muted:#94a3b8;
  --accent:#38bdf8;
  --ok:#22c55e;
  --warn:#f59e0b;
  --err:#ef4444;
  --radius:14px;
}

body{
  margin:0;
  background:radial-gradient(ellipse at top,#020617,#000);
  color:var(--text);
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;
}

.wrap{
  max-width:1100px;
  margin:32px auto;
  padding:0 18px 60px;
}

.header{
  padding:20px;
  border-radius:18px;
  border:1px solid var(--border);
}
.header h1{margin:0;font-size:28px;font-weight:900}
.header p{margin:6px 0 0;color:var(--muted);font-size:14px}

.section{
  margin-top:22px;
  padding:18px;
  border-radius:18px;
  border:1px solid var(--border);
}

.dropzone{
  border:2px dashed var(--border);
  border-radius:14px;
  padding:22px;
  text-align:center;
  cursor:pointer;
  margin-bottom:14px;
}
.dropzone.drag{border-color:var(--accent);background:rgba(56,189,248,.08)}

input[type="file"],select{
  width:100%;
  padding:10px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#020617;
  color:var(--text);
}

.actions{
  margin-top:14px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

button{
  padding:10px 14px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#020617;
  color:#fff;
  font-weight:800;
  cursor:pointer;
}
button.primary{background:var(--accent);border-color:transparent}
button:disabled{opacity:.4;cursor:not-allowed}

.status{
  margin-top:14px;
  padding:12px;
  border-radius:12px;
  font-size:14px;
}
.status.ok{background:rgba(34,197,94,.12);color:var(--ok)}
.status.warn{background:rgba(245,158,11,.12);color:var(--warn)}
.status.err{background:rgba(239,68,68,.12);color:var(--err)}

.preview{
  margin-top:16px;
  border-radius:14px;
  border:1px solid var(--border);
  background:#020617;
  padding:12px;
  font-family:ui-monospace,monospace;
  font-size:12px;
  white-space:pre;
  max-height:260px;
  overflow:auto;
}

.cols{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:10px;
}
.cols label{
  font-size:12px;
  background:#020617;
  border:1px solid var(--border);
  padding:6px 10px;
  border-radius:999px;
}
</style>
</head>

<body>
<div class="wrap">

<header class="header">
  <h1>Lens Uploads</h1>
  <p>IN8 (LMS BIN) · IN9 (Cost / Price)</p>
</header>

<section class="section">

  <!-- Drag & Drop -->
  <div id="dropzone" class="dropzone">
    Drag & drop Excel here or click to browse
    <input id="fileInput" type="file" accept=".xlsx,.xlsm" hidden>
  </div>

  <label>Sheet</label>
  <select id="sheetSelect" disabled></select>

  <div class="cols" id="columnPicker"></div>

  <div class="actions">
    <label><input type="radio" name="fmt" value="IN8" checked> IN8</label>
    <label><input type="radio" name="fmt" value="IN9"> IN9</label>
  </div>

  <div class="actions">
    <button id="previewBtn" class="primary" disabled>Preview CSV</button>
    <button id="downloadBtn" disabled>Download CSV</button>
  </div>

  <div id="status" class="status warn">Ready. Upload a file.</div>
  <div id="preview" class="preview">(no preview yet)</div>

</section>

<div class="actions">
  <a href="index.html" style="color:#fff;text-decoration:none">← Back to Dashboard</a>
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="in8-in9.js"></script>
</body>
</html>